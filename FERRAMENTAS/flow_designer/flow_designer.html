<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flow Designer - ELIS v2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f8f9fa;
            height: 100vh;
            display: flex;
        }
        
        .sidebar {
            width: 280px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            overflow-y: auto;
        }
        
        .sidebar h2 {
            margin-bottom: 20px;
            color: #ecf0f1;
            text-align: center;
        }
        
        .node-group {
            margin-bottom: 25px;
        }
        
        .node-group h3 {
            color: #bdc3c7;
            margin-bottom: 15px;
            font-size: 14px;
            text-transform: uppercase;
            border-bottom: 1px solid #34495e;
            padding-bottom: 5px;
        }
        
        .node-item {
            background: #34495e;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            border-left: 4px solid #3498db;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .node-item:hover {
            background: #3498db;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }
        
        .node-item:active {
            cursor: grabbing;
        }
        
        .node-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }
        
        .icon-page { background: #e74c3c; }
        .icon-process { background: #f39c12; }
        .icon-decision { background: #9b59b6; }
        .icon-end { background: #27ae60; }
        
        .canvas-container {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .toolbar {
            background: white;
            padding: 15px;
            border-bottom: 1px solid #ddd;
            display: flex;
            gap: 15px;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .canvas {
            flex: 1;
            background: white;
            margin: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .canvas-inner {
            width: 100%;
            height: 100%;
            position: relative;
            background-image: radial-gradient(circle, #e0e0e0 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .canvas.drag-over {
            border: 3px dashed #3498db;
            background: #ecf0f1;
        }
        
        .flow-node {
            position: absolute;
            background: white;
            border: 2px solid #3498db;
            border-radius: 12px;
            padding: 15px;
            min-width: 120px;
            min-height: 60px;
            cursor: move;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .flow-node:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }
        
        .flow-node.selected {
            border-color: #e74c3c;
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.4);
        }
        
        .node-page {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .node-process {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-color: #f093fb;
        }
        
        .node-decision {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            border-color: #4facfe;
            border-radius: 50%;
            width: 100px;
            height: 100px;
        }
        
        .node-end {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            border-color: #43e97b;
            border-radius: 50%;
            width: 80px;
            height: 80px;
        }
        
        .node-title {
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
        }
        
        .node-subtitle {
            font-size: 11px;
            opacity: 0.8;
        }
        
        .connection-line {
            position: absolute;
            pointer-events: none;
            z-index: 1;
        }
        
        .arrow {
            fill: #34495e;
        }
        
        .connection-point {
            position: absolute;
            width: 12px;
            height: 12px;
            background: #3498db;
            border: 2px solid white;
            border-radius: 50%;
            cursor: crosshair;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .flow-node:hover .connection-point {
            opacity: 1;
        }
        
        .point-right { right: -6px; top: 50%; transform: translateY(-50%); }
        .point-left { left: -6px; top: 50%; transform: translateY(-50%); }
        .point-top { top: -6px; left: 50%; transform: translateX(-50%); }
        .point-bottom { bottom: -6px; left: 50%; transform: translateX(-50%); }
        
        .properties-panel {
            width: 320px;
            background: white;
            border-left: 1px solid #ddd;
            padding: 20px;
            overflow-y: auto;
        }
        
        .properties-panel h3 {
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .property-group {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .property-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }
        
        .property-group input,
        .property-group select,
        .property-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #bdc3c7;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .property-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        
        .flow-info {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #3498db;
        }
        
        .flow-info h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .flow-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 12px;
        }
        
        .stat-item {
            text-align: center;
            padding: 8px;
            background: white;
            border-radius: 4px;
        }
        
        .connecting-mode {
            cursor: crosshair !important;
        }
        
        .connecting-mode .flow-node {
            cursor: crosshair !important;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>üìä Flow Designer</h2>
        
        <div class="node-group">
            <h3>P√°ginas</h3>
            <div class="node-item" draggable="true" data-type="page">
                <div class="node-icon icon-page">üìÑ</div>
                <div>
                    <div>P√°gina</div>
                    <small>Tela/Interface</small>
                </div>
            </div>
        </div>
        
        <div class="node-group">
            <h3>Processos</h3>
            <div class="node-item" draggable="true" data-type="process">
                <div class="node-icon icon-process">‚öôÔ∏è</div>
                <div>
                    <div>Processo</div>
                    <small>A√ß√£o/Fun√ß√£o</small>
                </div>
            </div>
            <div class="node-item" draggable="true" data-type="decision">
                <div class="node-icon icon-decision">‚ùì</div>
                <div>
                    <div>Decis√£o</div>
                    <small>Condi√ß√£o/Valida√ß√£o</small>
                </div>
            </div>
        </div>
        
        <div class="node-group">
            <h3>Finalizadores</h3>
            <div class="node-item" draggable="true" data-type="end">
                <div class="node-icon icon-end">‚úÖ</div>
                <div>
                    <div>Fim</div>
                    <small>T√©rmino do fluxo</small>
                </div>
            </div>
        </div>
        
        <div class="node-group">
            <h3>Templates</h3>
            <div class="node-item" onclick="loadTemplate('login')">
                <div class="node-icon" style="background: #8e44ad;">üîê</div>
                <div>
                    <div>Login Flow</div>
                    <small>Fluxo de autentica√ß√£o</small>
                </div>
            </div>
            <div class="node-item" onclick="loadTemplate('registration')">
                <div class="node-icon" style="background: #16a085;">üìù</div>
                <div>
                    <div>Cadastro</div>
                    <small>Fluxo de registro</small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="canvas-container">
        <div class="toolbar">
            <button class="btn btn-primary" onclick="clearCanvas()">üóëÔ∏è Limpar</button>
            <button class="btn btn-secondary" onclick="toggleConnectionMode()" id="connectBtn">üîó Conectar</button>
            <button class="btn btn-success" onclick="autoLayout()">üìê Auto Layout</button>
            <button class="btn btn-primary" onclick="exportFlow()">üíæ Exportar</button>
            <button class="btn btn-secondary" onclick="importFlow()">üìÇ Importar</button>
            <select id="zoomLevel" onchange="changeZoom()">
                <option value="0.5">50%</option>
                <option value="0.75">75%</option>
                <option value="1" selected>100%</option>
                <option value="1.25">125%</option>
                <option value="1.5">150%</option>
            </select>
        </div>
        
        <div class="canvas" id="canvas">
            <div class="canvas-inner" id="canvasInner">
                <svg id="connectionsSvg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" class="arrow" />
                        </marker>
                    </defs>
                </svg>
            </div>
        </div>
    </div>
    
    <div class="properties-panel">
        <div class="flow-info">
            <h4>Informa√ß√µes do Fluxo</h4>
            <div class="flow-stats">
                <div class="stat-item">
                    <strong id="nodeCount">0</strong><br>
                    <small>N√≥s</small>
                </div>
                <div class="stat-item">
                    <strong id="connectionCount">0</strong><br>
                    <small>Conex√µes</small>
                </div>
            </div>
        </div>
        
        <h3>Propriedades</h3>
        <div id="propertiesContent">
            <p style="text-align: center; color: #7f8c8d; margin-top: 50px;">Selecione um n√≥ para editar suas propriedades.</p>
        </div>
    </div>
    
    <script>
        let draggedElement = null;
        let selectedNode = null;
        let nodeCounter = 0;
        let connectionMode = false;
        let sourceNode = null;
        let connections = [];
        let currentZoom = 1;
        
        // Drag and Drop
        document.querySelectorAll('.node-item[draggable]').forEach(item => {
            item.addEventListener('dragstart', (e) => {
                draggedElement = e.target.closest('.node-item');
            });
        });
        
        const canvas = document.getElementById('canvas');
        const canvasInner = document.getElementById('canvasInner');
        
        canvas.addEventListener('dragover', (e) => {
            e.preventDefault();
            canvas.classList.add('drag-over');
        });
        
        canvas.addEventListener('dragleave', () => {
            canvas.classList.remove('drag-over');
        });
        
        canvas.addEventListener('drop', (e) => {
            e.preventDefault();
            canvas.classList.remove('drag-over');
            
            if (draggedElement) {
                const rect = canvasInner.getBoundingClientRect();
                const x = (e.clientX - rect.left) / currentZoom;
                const y = (e.clientY - rect.top) / currentZoom;
                
                createNode(draggedElement.dataset.type, x, y);
            }
        });
        
        function createNode(type, x, y, title = null, subtitle = null) {
            const node = document.createElement('div');
            node.className = `flow-node node-${type}`;
            node.style.left = x + 'px';
            node.style.top = y + 'px';
            node.dataset.type = type;
            node.dataset.id = 'node_' + (++nodeCounter);
            
            let defaultTitle = title || getDefaultTitle(type);
            let defaultSubtitle = subtitle || getDefaultSubtitle(type);
            
            node.innerHTML = `
                <div class="node-title">${defaultTitle}</div>
                <div class="node-subtitle">${defaultSubtitle}</div>
                <div class="connection-point point-right"></div>
                <div class="connection-point point-left"></div>
                <div class="connection-point point-top"></div>
                <div class="connection-point point-bottom"></div>
            `;
            
            // Event listeners
            node.addEventListener('mousedown', startDrag);
            node.addEventListener('click', selectNode);
            
            // Connection points
            node.querySelectorAll('.connection-point').forEach(point => {
                point.addEventListener('click', handleConnectionPoint);
            });
            
            canvasInner.appendChild(node);
            updateStats();
            
            return node;
        }
        
        function getDefaultTitle(type) {
            const titles = {
                'page': 'P√°gina',
                'process': 'Processo',
                'decision': 'Decis√£o?',
                'end': 'Fim'
            };
            return titles[type] || 'N√≥';
        }
        
        function getDefaultSubtitle(type) {
            const subtitles = {
                'page': 'Interface',
                'process': 'A√ß√£o',
                'decision': 'Condi√ß√£o',
                'end': 'T√©rmino'
            };
            return subtitles[type] || '';
        }
        
        function startDrag(e) {
            if (connectionMode) return;
            
            const node = e.target.closest('.flow-node');
            if (!node) return;
            
            let startX = e.clientX - node.offsetLeft * currentZoom;
            let startY = e.clientY - node.offsetTop * currentZoom;
            
            function drag(e) {
                node.style.left = ((e.clientX - startX) / currentZoom) + 'px';
                node.style.top = ((e.clientY - startY) / currentZoom) + 'px';
                updateConnections();
            }
            
            function stopDrag() {
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', stopDrag);
            }
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }
        
        function selectNode(e) {
            e.stopPropagation();
            
            if (selectedNode) {
                selectedNode.classList.remove('selected');
            }
            
            selectedNode = e.target.closest('.flow-node');
            selectedNode.classList.add('selected');
            
            showProperties(selectedNode);
        }
        
        function showProperties(node) {
            const propertiesContent = document.getElementById('propertiesContent');
            const type = node.dataset.type;
            const title = node.querySelector('.node-title').textContent;
            const subtitle = node.querySelector('.node-subtitle').textContent;
            
            propertiesContent.innerHTML = `
                <div class="property-group">
                    <label>Tipo:</label>
                    <select onchange="updateNodeType(this.value)">
                        <option value="page" ${type === 'page' ? 'selected' : ''}>P√°gina</option>
                        <option value="process" ${type === 'process' ? 'selected' : ''}>Processo</option>
                        <option value="decision" ${type === 'decision' ? 'selected' : ''}>Decis√£o</option>
                        <option value="end" ${type === 'end' ? 'selected' : ''}>Fim</option>
                    </select>
                </div>
                <div class="property-group">
                    <label>T√≠tulo:</label>
                    <input type="text" value="${title}" onchange="updateNodeTitle(this.value)">
                </div>
                <div class="property-group">
                    <label>Descri√ß√£o:</label>
                    <textarea onchange="updateNodeSubtitle(this.value)">${subtitle}</textarea>
                </div>
                <div class="property-group">
                    <label>Posi√ß√£o X:</label>
                    <input type="number" value="${parseInt(node.style.left)}" onchange="updateNodePosition('left', this.value + 'px')">
                </div>
                <div class="property-group">
                    <label>Posi√ß√£o Y:</label>
                    <input type="number" value="${parseInt(node.style.top)}" onchange="updateNodePosition('top', this.value + 'px')">
                </div>
                <div class="property-group">
                    <button class="btn btn-primary" onclick="deleteNode()" style="background: #e74c3c; width: 100%;">üóëÔ∏è Excluir N√≥</button>
                </div>
            `;
        }
        
        function updateNodeType(newType) {
            if (selectedNode) {
                selectedNode.className = `flow-node node-${newType} selected`;
                selectedNode.dataset.type = newType;
                updateNodeTitle(getDefaultTitle(newType));
                updateNodeSubtitle(getDefaultSubtitle(newType));
                showProperties(selectedNode);
            }
        }
        
        function updateNodeTitle(title) {
            if (selectedNode) {
                selectedNode.querySelector('.node-title').textContent = title;
            }
        }
        
        function updateNodeSubtitle(subtitle) {
            if (selectedNode) {
                selectedNode.querySelector('.node-subtitle').textContent = subtitle;
            }
        }
        
        function updateNodePosition(property, value) {
            if (selectedNode) {
                selectedNode.style[property] = value;
                updateConnections();
            }
        }
        
        function deleteNode() {
            if (selectedNode) {
                // Remove connections
                connections = connections.filter(conn => 
                    conn.source !== selectedNode.dataset.id && 
                    conn.target !== selectedNode.dataset.id
                );
                
                selectedNode.remove();
                selectedNode = null;
                document.getElementById('propertiesContent').innerHTML = '<p style="text-align: center; color: #7f8c8d; margin-top: 50px;">Selecione um n√≥ para editar suas propriedades.</p>';
                updateConnections();
                updateStats();
            }
        }
        
        function toggleConnectionMode() {
            connectionMode = !connectionMode;
            const btn = document.getElementById('connectBtn');
            
            if (connectionMode) {
                btn.textContent = '‚ùå Cancelar';
                btn.className = 'btn btn-secondary';
                document.body.classList.add('connecting-mode');
            } else {
                btn.textContent = 'üîó Conectar';
                btn.className = 'btn btn-secondary';
                document.body.classList.remove('connecting-mode');
                sourceNode = null;
            }
        }
        
        function handleConnectionPoint(e) {
            e.stopPropagation();
            
            if (!connectionMode) return;
            
            const node = e.target.closest('.flow-node');
            
            if (!sourceNode) {
                sourceNode = node;
                node.style.borderColor = '#f39c12';
            } else if (sourceNode !== node) {
                createConnection(sourceNode.dataset.id, node.dataset.id);
                sourceNode.style.borderColor = '';
                sourceNode = null;
                toggleConnectionMode();
            }
        }
        
        function createConnection(sourceId, targetId) {
            connections.push({ source: sourceId, target: targetId });
            updateConnections();
            updateStats();
        }
        
        function updateConnections() {
            const svg = document.getElementById('connectionsSvg');
            svg.innerHTML = svg.querySelector('defs').outerHTML;
            
            connections.forEach(conn => {
                const sourceNode = document.querySelector(`[data-id="${conn.source}"]`);
                const targetNode = document.querySelector(`[data-id="${conn.target}"]`);
                
                if (sourceNode && targetNode) {
                    const sourceRect = sourceNode.getBoundingClientRect();
                    const targetRect = targetNode.getBoundingClientRect();
                    const canvasRect = canvasInner.getBoundingClientRect();
                    
                    const x1 = (sourceRect.left + sourceRect.width/2 - canvasRect.left) / currentZoom;
                    const y1 = (sourceRect.top + sourceRect.height/2 - canvasRect.top) / currentZoom;
                    const x2 = (targetRect.left + targetRect.width/2 - canvasRect.left) / currentZoom;
                    const y2 = (targetRect.top + targetRect.height/2 - canvasRect.top) / currentZoom;
                    
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', x1);
                    line.setAttribute('y1', y1);
                    line.setAttribute('x2', x2);
                    line.setAttribute('y2', y2);
                    line.setAttribute('stroke', '#34495e');
                    line.setAttribute('stroke-width', '2');
                    line.setAttribute('marker-end', 'url(#arrowhead)');
                    
                    svg.appendChild(line);
                }
            });
        }
        
        function updateStats() {
            const nodeCount = canvasInner.querySelectorAll('.flow-node').length;
            const connectionCount = connections.length;
            
            document.getElementById('nodeCount').textContent = nodeCount;
            document.getElementById('connectionCount').textContent = connectionCount;
        }
        
        function clearCanvas() {
            canvasInner.innerHTML = '<svg id="connectionsSvg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;"><defs><marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" class="arrow" /></marker></defs></svg>';
            connections = [];
            selectedNode = null;
            nodeCounter = 0;
            document.getElementById('propertiesContent').innerHTML = '<p style="text-align: center; color: #7f8c8d; margin-top: 50px;">Selecione um n√≥ para editar suas propriedades.</p>';
            updateStats();
        }
        
        function autoLayout() {
            const nodes = canvasInner.querySelectorAll('.flow-node');
            const spacing = 200;
            let x = 100;
            let y = 100;
            
            nodes.forEach((node, index) => {
                node.style.left = x + 'px';
                node.style.top = y + 'px';
                
                x += spacing;
                if ((index + 1) % 4 === 0) {
                    x = 100;
                    y += spacing;
                }
            });
            
            updateConnections();
        }
        
        function changeZoom() {
            currentZoom = parseFloat(document.getElementById('zoomLevel').value);
            canvasInner.style.transform = `scale(${currentZoom})`;
            canvasInner.style.transformOrigin = 'top left';
        }
        
        function exportFlow() {
            const nodes = [];
            const nodeElements = canvasInner.querySelectorAll('.flow-node');
            
            nodeElements.forEach(node => {
                nodes.push({
                    id: node.dataset.id,
                    type: node.dataset.type,
                    title: node.querySelector('.node-title').textContent,
                    subtitle: node.querySelector('.node-subtitle').textContent,
                    x: parseInt(node.style.left),
                    y: parseInt(node.style.top)
                });
            });
            
            const flowData = {
                nodes: nodes,
                connections: connections,
                metadata: {
                    created: new Date().toISOString(),
                    nodeCount: nodes.length,
                    connectionCount: connections.length
                }
            };
            
            const blob = new Blob([JSON.stringify(flowData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'flow_diagram.json';
            a.click();
            
            URL.revokeObjectURL(url);
        }
        
        function importFlow() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const flowData = JSON.parse(e.target.result);
                            loadFlowData(flowData);
                        } catch (error) {
                            alert('Erro ao importar arquivo: ' + error.message);
                        }
                    };
                    reader.readAsText(file);
                }
            };
            
            input.click();
        }
        
        function loadFlowData(flowData) {
            clearCanvas();
            
            // Load nodes
            flowData.nodes.forEach(nodeData => {
                const node = createNode(nodeData.type, nodeData.x, nodeData.y, nodeData.title, nodeData.subtitle);
                node.dataset.id = nodeData.id;
            });
            
            // Load connections
            connections = flowData.connections || [];
            updateConnections();
            updateStats();
        }
        
        function loadTemplate(templateName) {
            const templates = {
                login: {
                    nodes: [
                        { id: 'node_1', type: 'page', title: 'P√°gina Login', subtitle: 'Tela de autentica√ß√£o', x: 100, y: 100 },
                        { id: 'node_2', type: 'process', title: 'Validar Credenciais', subtitle: 'Verificar usu√°rio/senha', x: 350, y: 100 },
                        { id: 'node_3', type: 'decision', title: 'V√°lido?', subtitle: 'Credenciais corretas?', x: 600, y: 100 },
                        { id: 'node_4', type: 'page', title: 'Dashboard', subtitle: 'P√°gina principal', x: 850, y: 50 },
                        { id: 'node_5', type: 'page', title: 'Erro Login', subtitle: 'Mensagem de erro', x: 600, y: 250 }
                    ],
                    connections: [
                        { source: 'node_1', target: 'node_2' },
                        { source: 'node_2', target: 'node_3' },
                        { source: 'node_3', target: 'node_4' },
                        { source: 'node_3', target: 'node_5' },
                        { source: 'node_5', target: 'node_1' }
                    ]
                },
                registration: {
                    nodes: [
                        { id: 'node_1', type: 'page', title: 'Formul√°rio Cadastro', subtitle: 'Dados do usu√°rio', x: 100, y: 100 },
                        { id: 'node_2', type: 'process', title: 'Validar Dados', subtitle: 'Verificar campos', x: 350, y: 100 },
                        { id: 'node_3', type: 'decision', title: 'Dados OK?', subtitle: 'Campos v√°lidos?', x: 600, y: 100 },
                        { id: 'node_4', type: 'process', title: 'Salvar Usu√°rio', subtitle: 'Criar conta', x: 850, y: 50 },
                        { id: 'node_5', type: 'page', title: 'Sucesso', subtitle: 'Conta criada', x: 1100, y: 50 },
                        { id: 'node_6', type: 'page', title: 'Erro Valida√ß√£o', subtitle: 'Corrigir campos', x: 600, y: 250 }
                    ],
                    connections: [
                        { source: 'node_1', target: 'node_2' },
                        { source: 'node_2', target: 'node_3' },
                        { source: 'node_3', target: 'node_4' },
                        { source: 'node_4', target: 'node_5' },
                        { source: 'node_3', target: 'node_6' },
                        { source: 'node_6', target: 'node_1' }
                    ]
                }
            };
            
            if (templates[templateName]) {
                loadFlowData(templates[templateName]);
            }
        }
        
        // Desselecionar ao clicar no canvas
        canvas.addEventListener('click', (e) => {
            if (e.target === canvas || e.target === canvasInner) {
                if (selectedNode) {
                    selectedNode.classList.remove('selected');
                    selectedNode = null;
                    document.getElementById('propertiesContent').innerHTML = '<p style="text-align: center; color: #7f8c8d; margin-top: 50px;">Selecione um n√≥ para editar suas propriedades.</p>';
                }
            }
        });
        
        // Initialize
        updateStats();
    </script>
</body>
</html>